(()=>{var e={};e.id=499,e.ids=[499],e.modules={5486:e=>{"use strict";e.exports=require("bcrypt")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},42449:e=>{"use strict";e.exports=require("pg")},33873:e=>{"use strict";e.exports=require("path")},79551:e=>{"use strict";e.exports=require("url")},67530:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>n.a,__next_app__:()=>c,pages:()=>d,routeModule:()=>m,tree:()=>u});var t=r(70260),a=r(28203),i=r(25155),n=r.n(i),o=r(67292),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(s,l);let u=["",{children:["(pages)",{children:["signup",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,53152)),"/Users/tahaparacha/Downloads/Coding/Main Projects/seagull/website/src/app/(pages)/signup/page.tsx"]}]},{}]},{"not-found":[()=>Promise.resolve().then(r.t.bind(r,19937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,71354)),"/Users/tahaparacha/Downloads/Coding/Main Projects/seagull/website/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,19937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["/Users/tahaparacha/Downloads/Coding/Main Projects/seagull/website/src/app/(pages)/signup/page.tsx"],c={require:r,loadChunk:()=>Promise.resolve()},m=new t.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/(pages)/signup/page",pathname:"/signup",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:u}})},79392:(e,s,r)=>{"use strict";r.r(s),r.d(s,{"001ceca995e446d8feebb36954bff66df1af521413":()=>i.m,"401af72ff7f7d55f51261b404620916ec184026e28":()=>c.A,"401c375d175b3bc04c185da96fc99497d2f03fc5ff":()=>d.A,"404d2a60c440802fda175063cb62a4ab50ddfb22da":()=>o.A,"408ca83da2a7494c7a7781ffd9ab611ba56ee51811":()=>u.A,"40f6de09ec2822252f3fdfc0bb278e4ae125d2c60a":()=>a.d,"40f8f2f090ca352e6b95c38277e385fc1dd79b6b94":()=>l.A,"6098242062054845d9c23bff0445dbf4ba7b3e57ee":()=>i.P,"60c448cf360e41d7f8ac8c944614f59edb8e5c9841":()=>m.A,"60d1f6e8477b5a8c6b0fdcae07b94e02c8d4cb1269":()=>f.A,"60e17cb2baeee781bd9da0356c33ad975f46aaf1c0":()=>n.A,"7f5f553b95b32f91fbfa62b02a301ed5755c7b9bb6":()=>t.q});var t=r(18482),a=r(21337),i=r(76109),n=r(71807),o=r(42734),l=r(50679),u=r(18251),d=r(89321),c=r(91278),m=r(49695),f=r(81790)},15882:(e,s,r)=>{"use strict";r.r(s),r.d(s,{"402e08fa5ca5f79ed844eb33f6e3b2777713e1049e":()=>c});var t=r(21590);r(70376);var a=r(13362),i=r(5486),n=r.n(i);async function o(e){let s=parseInt(process.env.SALT_ROUNDS||"10");return n().hash(e,s)}var l=r(18394),u=r(97792),d=r(37855);async function c(e){if(!e||!e.firstName&&!e.lastName&&!e.email&&!e.password)return{success:!1,status:400,msg:"Invalid data"};if(!e.firstName.trim()||e.firstName.trim().length>60||e.firstName.trim().length<2)return{success:!1,status:400,msg:"Invalid first name"};if(!e.lastName.trim()||e.lastName.trim().length>60||e.lastName.trim().length<2)return{success:!1,status:400,msg:"Invalid last name"};if(!e.email.trim()||e.email.trim().length>255||e.email.trim().length<4||!e.email.includes("@")||!e.email.includes("."))return{success:!1,status:400,msg:"Invalid email"};if(!e.password.trim()||e.password.trim().length>255||e.password.trim().length<8)return{success:!1,status:400,msg:"Invalid password"};let s=`${e.email.trim().toLowerCase().split("@")[0]}${Math.floor(1e4*Math.random())}`;try{let r=await o(e.password.trim()),t=[s,e.firstName,e.lastName,e.email,r,new Date],i=await (0,a.P)("INSERT INTO users (slug, first_name, last_name, email, password, created_at) VALUES ($1, $2, $3, $4, $5, $6) RETURNING id",t);if(!i)return{success:!1,status:500,msg:"A database error occurred"};if(0===i.rowCount)return{success:!1,status:500,msg:"User not created"};if(1!==i.rowCount)return{success:!1,status:500,msg:"Invalid user creation"};let n=(0,l.A)(),c=await (0,u.j)(n,i.rows[0].id),m=null;return c&&(m=c,await (0,d.m)(n,m.expiresAt)),{success:!0,status:200,msg:"User created",user:{id:i.rows[0].id,firstName:e.firstName.trim(),lastName:e.lastName.trim(),email:e.email.trim(),slug:s.trim(),tags:[],avatar:1,avatar_url:"/public/images/orange.svg",about:"",onboarding:0,hireable:!1,experience:[],followed:[],followers:[],followersCount:0,followingCount:0},session:m}}catch(e){return{success:!1,status:400,msg:e?`${`${e}`.includes("error: ")?`${e}`.split("error: ")[1].trim():e}`:"A server error occurred"}}}(0,r(99344).D)([c]),(0,t.A)(c,"402e08fa5ca5f79ed844eb33f6e3b2777713e1049e",null)},63871:(e,s,r)=>{Promise.resolve().then(r.t.bind(r,59607,23)),Promise.resolve().then(r.bind(r,48603))},823:(e,s,r)=>{Promise.resolve().then(r.t.bind(r,28531,23)),Promise.resolve().then(r.bind(r,33729))},79334:(e,s,r)=>{"use strict";var t=r(58686);r.o(t,"usePathname")&&r.d(s,{usePathname:function(){return t.usePathname}}),r.o(t,"useRouter")&&r.d(s,{useRouter:function(){return t.useRouter}}),r.o(t,"useSearchParams")&&r.d(s,{useSearchParams:function(){return t.useSearchParams}})},33729:(e,s,r)=>{"use strict";r.d(s,{default:()=>f});var t=r(45512),a=r(47929),i=r.n(a),n=r(79334),o=r(97734),l=r(26248);let u=(0,l.createServerReference)("402e08fa5ca5f79ed844eb33f6e3b2777713e1049e",l.callServer,void 0,l.findSourceMapURL,"default");var d=r(58009),c=r(92273),m=r(50520);function f(){let e=(0,n.useRouter)(),s=(0,n.useSearchParams)(),[r,a]=(0,d.useState)({isError:!1,msg:""}),l=(0,c.wA)();async function f(r){r.preventDefault(),a({isError:!1,msg:""});let{user:t}=await (0,o.q)();if(t){e.push("/"),a({isError:!0,msg:"You're already logged in"});return}let i=new FormData(r.target),n={firstName:i.get("firstName")?.toString().toLowerCase().trim(),lastName:i.get("lastName")?.toString().toLowerCase().trim(),email:i.get("email")?.toString().toLowerCase().trim(),password:i.get("password")?.toString().toLowerCase().trim()};if(!n||!n.firstName&&!n.lastName&&!n.email&&!n.password){a({isError:!0,msg:"Please fill in the form"});return}if(!n.firstName||n.firstName.length>60||n.firstName.length<2){a({isError:!0,msg:"Please enter a valid first name"});return}if(!n.lastName||n.lastName.length>60||n.lastName.length<2){a({isError:!0,msg:"Please enter a valid last name"});return}if(!n.email||n.email.length>255||n.email.length<4||!n.email.includes("@")||!n.email.includes(".")){a({isError:!0,msg:"Please enter a valid email"});return}if(!n.password||n.password.length>255||n.password.length<8){a({isError:!0,msg:"Please enter a stronger password"});return}let d=await u({firstName:`${n.firstName.trim()}`,lastName:`${n.lastName.trim()}`,email:`${n.email.trim()}`,password:`${n.password}`});if(!d){a({isError:!0,msg:"An error occurred"});return}if(!d.success){let e=d.msg;if(d.msg.includes("Invalid"))e=`Please enter a valid ${d.msg.split("Invalid ")[1]}`;else switch(d.msg){case'duplicate key value violates unique constraint "users_email_key"':case'duplicate key value violates unique constraint "users_slug_key"':e="A user already exists with that email";break;default:e=d.msg}a({isError:!0,msg:e});return}let c=null===s.get("redirect")?"/profile":s.get("redirect");e.push(c||"/profile"),l((0,m.gV)(d.user))}return(0,t.jsxs)("form",{onSubmit:f,className:i().form,children:[(0,t.jsx)("input",{name:"firstName",type:"text",placeholder:"First name"}),(0,t.jsx)("input",{name:"lastName",type:"text",placeholder:"Last name"}),(0,t.jsx)("input",{name:"email",type:"text",placeholder:"Email"}),(0,t.jsx)("input",{name:"password",type:"text",placeholder:"Password"}),(0,t.jsx)("button",{children:"Signup"}),r.isError&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{children:"Error!"}),(0,t.jsxs)("p",{children:[" ",r.msg," "]})]})]})}},47929:e=>{e.exports={form:"signupForm_form__EmjA4"}},59607:(e,s,r)=>{let{createProxy:t}=r(73439);e.exports=t("/Users/tahaparacha/Downloads/Coding/Main Projects/seagull/website/node_modules/next/dist/client/app-dir/link.js")},48603:(e,s,r)=>{"use strict";r.d(s,{default:()=>t});let t=(0,r(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/tahaparacha/Downloads/Coding/Main Projects/seagull/website/src/app/(pages)/signup/SignupForm.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/tahaparacha/Downloads/Coding/Main Projects/seagull/website/src/app/(pages)/signup/SignupForm.tsx","default")},53152:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>u});var t=r(62740),a=r(31831),i=r(18482),n=r(48603),o=r(59607),l=r.n(o);async function u(){let{user:e}=await (0,i.q)();return null!==e?(0,a.redirect)("/profile"):(0,t.jsx)("div",{className:"wrapper",children:(0,t.jsxs)("div",{className:"container",children:[(0,t.jsx)("h2",{children:" Welcome to Seagull, Signup "}),(0,t.jsx)(n.default,{}),(0,t.jsx)(l(),{href:"/login",children:"Already have an account? Login"})]})})}},18482:(e,s,r)=>{"use strict";r.d(s,{q:()=>l});var t=r(88977);r(98063);var a=r(44512),i=r(76301),n=r(21337),o=r(56215);let l=(0,i.cache)(async()=>{let e=await (0,a.UL)(),s=e.get("session")?.value??null;return null===s?{session:null,user:null}:await (0,n.d)(s)});(0,o.D)([l]),(0,t.A)(l,"7f5f553b95b32f91fbfa62b02a301ed5755c7b9bb6",null)},37855:(e,s,r)=>{"use strict";r.d(s,{m:()=>i});var t=r(21590);r(70376);var a=r(42385);async function i(e,s){(await (0,a.UL)()).set("session",e,{httpOnly:!0,sameSite:"lax",secure:!0,expires:s,path:"/"})}(0,r(99344).D)([i]),(0,t.A)(i,"60ec433cda06725b5640b902ce3a3d04b79273dc0a",null)},97792:(e,s,r)=>{"use strict";r.d(s,{j:()=>o});var t=r(21590);r(70376);var a=r(13362),i=r(64230),n=r(57647);async function o(e,s){let r={id:(0,i.tO)((0,n.sc)(new TextEncoder().encode(e))),userId:s,createdAt:new Date(Date.now()),expiresAt:new Date(Date.now()+2592e6)},t=[r.id,r.userId,r.createdAt,r.expiresAt];try{let e=await (0,a.P)("INSERT INTO user_sessions (id, user_id, created_at, expires_at) VALUES ($1, $2, $3, $4)",t);if(console.log(e),!e||!e.rowCount||1!==e.rowCount)throw"Session not created";return r}catch(e){return console.log(e),null}}(0,r(99344).D)([o]),(0,t.A)(o,"6012cc3921ca54aa209a49baab3933c78f1d086c3b",null)},18394:(e,s,r)=>{"use strict";r.d(s,{A:()=>a});var t=r(64230);function a(){let e=new Uint8Array(20);return crypto.getRandomValues(e),(0,t.Kg)(e)}},21337:(e,s,r)=>{"use strict";r.d(s,{d:()=>l});var t=r(88977);r(98063);var a=r(76109),i=r(64397),n=r(8147),o=r(71807);async function l(e){let s=(0,i.tO)((0,n.sc)(new TextEncoder().encode(e))),r=await (0,a.P)(`
        SELECT 
            s.id AS session_id, 
            s.user_id, 
            s.created_at AS session_created_at, 
            s.expires_at,
            u.slug
        FROM user_sessions s
        INNER JOIN users u
            ON u.id = s.user_id 
        WHERE s.id = $1`,[s]);if(!r||0===r.rowCount)return{session:null,user:null};let t=r.rows[0],l=await (0,o.A)(t.slug,!0);if(!l.success||!l.user)return{session:null,user:null};let u={id:t.session_id,userId:t.user_id,createdAt:new Date(t.session_created_at.toISOString()),expiresAt:new Date(t.expires_at.toISOString())},d=new Date(u.expiresAt);return Date.now()>=d.getTime()?(await (0,a.P)("DELETE FROM user_sessions WHERE id = $1",[u.id]),{session:null,user:null}):(Date.now()>=d.getTime()-2592e6&&(u.expiresAt=new Date(Date.now()+2592e6),await (0,a.P)("UPDATE user_sessions SET expires_at = $1 WHERE id = $2",[u.expiresAt,u.id])),{session:u,user:l.user})}(0,r(56215).D)([l]),(0,t.A)(l,"40f6de09ec2822252f3fdfc0bb278e4ae125d2c60a",null)},13362:(e,s,r)=>{"use strict";r.d(s,{P:()=>l});var t=r(21590);r(70376);var a=r(42449),i=r(99344);let n=new a.Pool({host:process.env.DB_HOST,user:process.env.DB_USER,port:5432,password:process.env.DB_PASSWORD,database:process.env.DB_DATABASE,ssl:!0});async function o(){return(await n.query("SELECT version();")).rows}async function l(e,s){return await n.query(e,s||[])}(0,i.D)([o,l]),(0,t.A)(o,"001ceca995e446d8feebb36954bff66df1af521413",null),(0,t.A)(l,"6098242062054845d9c23bff0445dbf4ba7b3e57ee",null)}};var s=require("../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),t=s.X(0,[638,246,825,77,635,512,819,436,382],()=>r(67530));module.exports=t})();